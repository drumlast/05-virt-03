# Домашнее задание к занятию 4 «Оркестрация группой Docker контейнеров на примере Docker Compose»

### Задача 1

Ссылка на образ докер nginx
https://hub.docker.com/repository/docker/drumlast/custom-nginx/general

### Задача 2

![txt](img/1.jpg)
![txt](img/2.jpg)

### Задача 3

Подключаемся к STDIN/STDOUT/STDERR контейнера с помощью команды docker attach
![txt](img/3.jpg)

Контейнер остановился потому что docker attach присоединяет клавиатуру к PID 1 процесса в контейнере (у nginx это master-процесс). Сигнал SIGINT (Ctrl-C) прилетает в главный процесс, и тот завершает работу — контейнер считается остановленным, так как завершился его основной процесс.

Проверка с хоста с объяснением проблемы:  «сломалось» потому, что при старте был публиковал порт так: -p 127.0.0.1:8080:80. Это проброс порта хоста 8080 внутри контейнера га порт 80. После правки nginx слушает 81, а проброс остался на 80, где теперь никто не слушает — поэтому curl 127.0.0.1:8080 падает.
![txt](img/4.jpg)
![txt](img/5.jpg)

```
docker rm -f custom-nginx-t2
```
![txt](img/6.jpg)

### Задача 4

![txt](img/7.jpg)

### Задача 5

Команда docker compose up -d по умолчанию читает файлы в порядке приоритета: compose.yaml, compose.yml, docker-compose.yaml, docker-compose.yml.
Значит, будет запущен только compose.yaml (Portainer), потому что он имеет более высокий приоритет.
![txt](img/8.jpg)

Здесь уже запущены 2 файла: compose.yaml и docker-compose.yaml
![txt](img/9.jpg)

----------------------------------------
![txt](img/10.jpg)
![txt](img/11.jpg)
![txt](img/12.jpg)
![txt](img/13.jpg)
![txt](img/14.jpg)
-----------------------------------------
![txt](img/15.jpg)
Compose обнаружил «осиротевшие» сервисы/контейнеры (например, portainer), которые были в ранее использованном файле, но не описаны в текущем. Предлагается удалить «orphans», чтобы состояние соответствовало текущему манифесту.
```
docker compose up -d --remove-orphans
```